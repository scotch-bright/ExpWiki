<!DOCTYPE html>
<html>
<head>
	<title>Merge Sort :: A Visual Demo By Khoj Badami</title>
	<style type="text/css">
		canvas {
			border: 1px solid lightgrey;
		}
	</style>
</head>
<body>
	<script src="./libs/jquery-3.5.1.min.js"></script>
	<script src="./libs/matter.min.js"></script>
	<script src="./libs/decomp.min.js"></script>
	<script src="./libs/path-data-polyfill.js"></script>
	<script src="./merge-sort-resources/matterJSBodyBuilders.js"></script>
	
	<script type="text/javascript">
		let allBodies = {};
		let currentIndexOfActionWhenBodiesStopMoving = 0;
		let numbersToBeSorted = [];
		let numberOfSplits = 0;
	</script>

	<script src="./merge-sort-resources/matterJSWorldSetup.js"></script>
	<script type="text/javascript">

		let actionsWhenObjectsStopMoving = [
			() => {
				World.remove(world, allBodies.l0Platform1);
				World.remove(world, allBodies.l0Platform2);
				World.remove(world, allBodies.l0Stopper1);
				World.remove(world, allBodies.l0Stopper2);
			},
			() => {
				World.remove(world, allBodies.level2_p2);
				World.remove(world, allBodies.level2_p3);
				World.remove(world, allBodies.level2_s2);
				World.remove(world, allBodies.level2_s3);
				World.remove(world, allBodies.level2_p4);
				World.remove(world, allBodies.level2_s4);
				World.remove(world, allBodies.level2_p1);
				World.remove(world, allBodies.level2_s1);
			}
		]

		function mergeSort(input) {
			if (input.length == 1) {
				return input;
			}
			else {
				let arrayParts = mergeSortInputSplitter(input);
				let firstPartSorted = mergeSort(arrayParts.firstHalf);
				let secondPartSorted = mergeSort(arrayParts.secondHalf);
				return mergeSortedArrays(firstPartSorted, secondPartSorted);
			}
		}

		function mergeSortedArrays(sortedArray1, sortedArray2) {
			let output = [];
			let sortedArray1Idx = 0;
			let sortedArray2Idx = 0;
			while (sortedArray1[sortedArray1Idx] != undefined || sortedArray2[sortedArray2Idx] != undefined) {
				
				if (sortedArray1[sortedArray1Idx] == undefined) {
					output.push(
						sortedArray2[sortedArray2Idx]
					);
					sortedArray2Idx += 1;
					continue;
				}
			
				if (sortedArray2[sortedArray2Idx] == undefined) {
					output.push(
						sortedArray1[sortedArray1Idx]
					);
					sortedArray1Idx += 1;
					continue;
				}

				if (sortedArray2[sortedArray2Idx] > sortedArray1[sortedArray1Idx]) {
					output.push(
						sortedArray1[sortedArray1Idx]
					);
					sortedArray1Idx += 1;
					continue;
				}
				else {
					output.push(
						sortedArray2[sortedArray2Idx]
					);
					sortedArray2Idx += 1;
					continue;
				}

			}
			return output;
 		}

		function mergeSortInputSplitter(input) {
			numberOfSplits += 1;
			let duplicatedArray = [...input];
			let halfTheInputLength = undefined;
			if (input.length % 2 == 0 || numberOfSplits % 2 == 0) {
				halfTheInputLength = duplicatedArray.length / 2;
			}
			else {
				halfTheInputLength = duplicatedArray.length / 2 + 1;
			}
			return {
				firstHalf: duplicatedArray.splice(0, halfTheInputLength),
				secondHalf: duplicatedArray
			}
		}

	</script>
</body>
</html>